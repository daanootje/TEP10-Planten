<link rel="import" href="../../../bower_components/polymer/polymer.html">
<link rel="import" href="../leverancier-actions/leverancier-actions.html">
<link rel="import" href="../t10-data-table/t10-data-table.html">
<link rel="import" href="../util/columns.html">

<dom-module id="sub-container">

  <template>
    <style>
      :host {
        display: flex;
        flex-wrap: wrap;
        flex-direction: column;
        margin: 30px;
      }
    </style>

    <leverancier-actions leverancier=[[levnaam]] on-show-bestelling="showBestellingTapped"></leverancier-actions>
    <template is="dom-if" if="[[showBestelling]]">
      <iron-ajax
      auto
      url='http://localhost:8080/leveranciers/[[levcode]]/bestellingen'
      params=''
      handle-as="json"
      on-response="handleBestellingResponse"
      debounce-duration="300"></iron-ajax>
      <t10-data-table
        items=[[bestellingen]]
        columns=[[bestellingenColumns]]
        table-name="Bestellingen van [[levnaam]]"
        style="margin-top: 30px">
      </t10-data-table>
    </template>

  </template>

  <script>
    Polymer({
        is: 'sub-container',
        properties: {
          levnaam: String,
          levcode: Number,
          bestellingen: Array,
          showBestelling: Boolean,
          bestellingenColumns: {
            type: Array,
            value: columns.bestellingen
          }
        },
        handleBestellingResponse(response) {
          this.bestellingen = response.detail.response;
        },
        showBestellingTapped(e) {
          this.showBestelling = !this.showBestelling;
        },
        listeners: {
          'show-bestelling-changed': 'showBestellingTapped'
        },
      });
  </script>
</dom-module>
