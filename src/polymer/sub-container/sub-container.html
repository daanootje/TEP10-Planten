<link rel="import" href="../../../bower_components/polymer/polymer.html">
<link rel="import" href="../leverancier-actions/leverancier-actions.html">
<link rel="import" href="../t10-data-table/t10-data-table.html">
<link rel="import" href="../util/columns.html">

<dom-module id="sub-container">

  <template>
    <style>
      :host {
        display: flex;
        flex-wrap: wrap;
        flex-direction: column;
        margin: 30px;
      }
    </style>

    <leverancier-actions
    leverancier=[[levnaam]]
    on-show-bestelling="showBestellingTapped"
    on-show-offertes="showOffertesTapped"></leverancier-actions>
    <template is="dom-if" if="[[showTable]]">
      <iron-ajax
      auto
      url='[[tableCall]]'
      params=''
      handle-as="json"
      on-response="handleItemRequest"
      debounce-duration="300"></iron-ajax>
      <t10-data-table
        items=[[items]]
        columns=[[itemColumns]]
        table-name="[[tableName]]"
        style="margin-top: 30px">
      </t10-data-table>
    </template>

  </template>

  <script>
    Polymer({
        is: 'sub-container',
        properties: {
          levnaam: String,
          levcode: Number,
          items: Array,
          showTable: Boolean,
          itemColumns: Array,
          tableName: String,
          tableCall: String
        },
        handleItemRequest(response) {
          this.items = response.detail.response;
        },
        showBestellingTapped(e) {
          this.items = [];
          this.showTable = true;
          this.itemColumns = columns.bestellingen;
          this.tableName = "Bestellingen van " + this.levnaam;
          this.tableCall = "http://localhost:8080/leveranciers/" + this.levcode + "/bestellingen";
        },
        showOffertesTapped(e) {
          this.items = [];
          this.showTable = true;
          this.itemColumns = columns.offertes;
          this.tableName = "Offertes van " + this.levnaam;
          this.tableCall = "http://localhost:8080/leveranciers/" + this.levcode + "/offertes";
        }
      });
  </script>
</dom-module>
