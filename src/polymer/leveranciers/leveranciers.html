<link rel="import" href="../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../../bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="../../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../api/leveranciers.html">
<link rel="import" href="../quantity-element/quantity-element.html">
<link rel="import" href="../bestellingen-element/bestellingen-element.html">
<link rel="import" href="../../../bower_components/paper-datatable/paper-datatable.html">
<link rel="import" href="../../../bower_components/d2l-button/d2l-button.html">

<dom-module id="leveranciers-element">
  <template>
    <iron-ajax
    auto
    url='[[apiUrl]]'
    params=''
    handle-as="json"
    on-response="handleLeveranciersResponse"
    debounce-duration="300"></iron-ajax>
    <style>
      :host {
        display: block;
      }
      .table-data-column {
        text-align: center;
      }
      .table-action-column {
        width: 150px;
      }
      .table-button {
        display: flex;
        margin-left: auto;
        margin-right: auto;
      }
    </style>

    <h3>Leveranciers</h3>

    <paper-datatable id="datatable1" data="{{leveranciers}}">
        <paper-datatable-column header="Code" property="levcode" sortable>
        </paper-datatable-column>
        <paper-datatable-column header="Naam" property="levnaam" sortable>
        </paper-datatable-column>
        <paper-datatable-column header="Adres" property="adres" sortable>
        </paper-datatable-column>
        <paper-datatable-column header="Woonplaats" property="woonplaats" sortable>
        </paper-datatable-column>
        <paper-datatable-column header="Action" sortable>
          <template>
               <d2l-button>Bestellingen</d2l-button>
          </template>
        </paper-datatable-column>
    </paper-datatable>

    <h3>a {{route.path}}</h3>

  </template>

  <script>
    Polymer({
      is: 'leveranciers-element',
      properties: {
        apiUrl: {
          type: Object,
          value: leveranciersApi.getAll
        },
        leveranciers: {
          type: Array,
          value: [
            {levcode: "bla", bla: "adf"}
          ]
        }
      },
      handleLeveranciersResponse(response) {
        this.leveranciers = response.detail.response.content;
      },
      bestellingTapped(forItem) {
        console.log(this.route);
        this.set('route.view', 'bestellingen');
        this.set('route.routeData', {
          id: forItem.levcode,
          name: forItem.levnaam
        });
      },
      listeners: {
        'row-tap': 'handleRowTap'
      },
      handleRowTap(e) {
        this.bestellingTapped(e.detail.item)
      }
    })

  </script>
</dom-module>
