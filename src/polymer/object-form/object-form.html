<link rel="import" href="../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../../bower_components/iron-ajax/iron-ajax.html">
<script src="http://code.jquery.com/jquery-latest.min.js" type="text/javascript"></script>

<dom-module id="object-form">

  <template>
    <style>
      :host {
        display: flex;
        margin-top: 30px;
        animation: strollin 1s, fadein 1s;
      }
      .form {
        padding: 30px
      }
      .submit-button {
        float:right;
        background-color: white;
        margin-top:30px;
      }
    </style>

    <paper-card heading="{{object.header}}" style="width: 100%; background-color: #e6ffe6;">
      <iron-form>
      <form id="iron-form" class="form">
        <template is="dom-repeat" items="{{object.categories}}">
          <paper-input name="{{item.name}}" label="{{item.label}}" value="{{item.value}}"></paper-input>
        </template>
        <paper-button class="submit-button" on-tap="save" raised>opslaan</paper-button>
      </form>
    </iron-form>
    <paper-card>

  </template>

  <script>
    Polymer({
        is: 'object-form',
        properties: {
          object: Object,
          imageUrl: String
        },
        save() {
          var form = document.getElementById('iron-form');
          var newObject = {};
          this.object.categories.forEach(value => {
            newObject[value.name] = form.elements[value.name].value;
          })
          newObject.levcode = this.object.levcode;
          $.ajax({
              contentType: 'application/json',
              data: JSON.stringify(newObject),
              dataType: 'json',
              processData: false,
              type: 'POST',
              url: "http://localhost:8080/leveranciers/" + this.object.levcode + "/bestellingen"
          }).done(a => {
            this.fire("button-tap");
          });
        }
      });
  </script>
</dom-module>
